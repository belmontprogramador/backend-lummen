generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  SUPER
  ADMIN
}

model Admin {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  role      Role     @default(ADMIN)
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
}

enum PaymentStatus {
  PENDING
  PAID
  EXPIRED
  CANCELED
}

enum BoostType {
  BOOST
  SUPERBOOST
}

enum BoostStatus {
  PENDING
  ACTIVE
  EXPIRED
  CANCELED
}

enum Pronoun {
  HE_HIM
  SHE_HER
  THEY_THEM
  OTHER
}

enum Gender {
  MALE
  FEMALE
  NON_BINARY
  OTHER
}

enum Intention {
  FRIENDS
  DATING
  LONG_TERM
  CASUAL
  NETWORKING
  OTHER
}

enum RelationshipType {
  MONOGAMY
  NON_MONOGAMY
  OPEN
  OTHER
}

enum EducationLevel {
  HIGH_SCHOOL
  BACHELOR
  MASTER
  PHD
  OTHER
}

enum SmokingStatus {
  NO
  SOCIALLY
  YES
}

enum DrinkingStatus {
  NO
  SOCIALLY
  YES
}

enum ActivityFrequency {
  LOW
  MEDIUM
  HIGH
}

enum PetsPreference {
  NONE
  DOG
  CAT
  DOG_AND_CAT
  OTHER
}

enum CommunicationStyle {
  DIRECT
  HUMOR
  EMPATHETIC
  ANALYTICAL
  OTHER
}

enum ZodiacSign {
  ARIES
  TAURUS
  GEMINI
  CANCER
  LEO
  VIRGO
  LIBRA
  SCORPIO
  SAGITTARIUS
  CAPRICORN
  AQUARIUS
  PISCES
  OTHER
}

enum SexualOrientation {
  STRAIGHT
  GAY
  LESBIAN
  BISEXUAL
  ASEXUAL
  PANSEXUAL
  QUEER
  OTHER
}

enum Language {
  ENGLISH
  SPANISH
  PORTUGUESE
  FRENCH
  GERMAN
  ITALIAN
  CHINESE
  JAPANESE
  KOREAN
  ARABIC
  HINDI
  OTHER
}

enum InterestActivity {
  TRAVEL
  COOKING
  READING
  HIKING
  BEACH
  VIDEO_GAMES
  PHOTOGRAPHY
  GYM
  RUNNING
  YOGA
  OTHER
}

enum InterestLifestyle {
  HEALTHY
  VEGAN
  MINIMALIST
  ENTREPRENEUR
  DIGITAL_NOMAD
  PET_LOVER
  SPIRITUAL
  ECO_FRIENDLY
  OTHER
}

enum InterestCreativity {
  ART
  DRAWING
  PAINTING
  WRITING
  DANCING
  DESIGN
  MAKEUP
  CRAFTS
  OTHER
}

enum InterestSports {
  FOOTBALL
  SOCCER
  BASKETBALL
  TENNIS
  BOXING
  MMA
  SWIMMING
  CYCLING
  CROSSFIT
  RUNNING
  GYM
  OTHER
}

enum InterestMusic {
  POP
  ROCK
  RAP
  EDM
  JAZZ
  CLASSICAL
  HIPHOP
  COUNTRY
  REGGAE
  BLUES
  KPOP
  MPB
  OTHER
}

enum InterestNightlife {
  BARS
  CLUBS
  LOUNGES
  CONCERTS
  FESTIVALS
  KARAOKE
  LIVE_MUSIC
  OTHER
}

enum InterestTvCinema {
  ACTION
  COMEDY
  DRAMA
  HORROR
  ROMANCE
  FANTASY
  SCIFI
  DOCUMENTARY
  ANIME
  SERIES
  MOVIES
  OTHER
}

model User {
  id        String     @id @default(uuid()) @db.Uuid
  email     String     @unique
  name      String?
  password  String
  photo     String

  isPaid      Boolean    @default(false)
  paidUntil   DateTime?
  status      UserStatus @default(ACTIVE)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Plano
  planId   String? @db.Uuid
  plan     Plan?   @relation(fields: [planId], references: [id])

  // NOVO PERFIL UNIFICADO
  profile     UserProfile?

  // Prefer√™ncias
  preference  UserPreference?

  photos        UserPhoto[]
  payments      Payment[]
  credits       BoostCredit[]
  boosts        BoostActivation[]
  likesSent     Like[]            @relation("LikesSent")
  likesReceived Like[]            @relation("LikesReceived")
}

model Plan {
  id        String   @id @default(uuid()) @db.Uuid
  name      String   @unique
  title     String
  features  Json
  price     Decimal  @db.Decimal(10,2)
  durationDays Int
  allowedRoutes Json @default("[]")
   routePayment Json  @default("{}")          // mapa { tag: boolean }

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  users  User[]
  routes Route[] @relation("PlanRoutes")
}

model Route {
  id        String   @id @default(uuid()) @db.Uuid
  name      String
  tag       String   @unique
  path      String
  method    String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  plans     Plan[]   @relation("PlanRoutes")
}

model UserPhoto {
  id        String   @id @default(uuid()) @db.Uuid
  userId    String   @db.Uuid
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  url       String
  position  Int
  createdAt DateTime @default(now())

  @@unique([userId, position])
  @@index([userId])
}

model UserPreference {
  userId        String   @id @db.Uuid
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  // FILTROS PRINCIPAIS
  preferredGenders Gender[] @default([])
  preferredOrientations SexualOrientation[] @default([])
  preferredPronouns Pronoun[] @default([])
  preferredZodiacs ZodiacSign[] @default([])

  // RELA√á√ÉO / INTEN√á√ÉO
  preferredIntentions        Intention[]        @default([])
  preferredRelationshipTypes RelationshipType[] @default([])

  // LIFESTYLE / H√ÅBITOS
  preferredPets          PetsPreference[]     @default([])
  preferredSmoking       SmokingStatus[]      @default([])
  preferredDrinking      DrinkingStatus[]     @default([])
  preferredActivityLevel ActivityFrequency[]   @default([])
  preferredCommunication CommunicationStyle[] @default([])

  // TRABALHO E EDUCA√á√ÉO
  preferredEducationLevels EducationLevel[] @default([])

  // L√çNGUAS
  preferredLanguages Language[] @default([])

  // INTERESSES
  preferredInterestsActivities    InterestActivity[]    @default([])
  preferredInterestsLifestyle     InterestLifestyle[]   @default([])
  preferredInterestsCreativity    InterestCreativity[]  @default([])
  preferredInterestsSportsFitness InterestSports[]      @default([])
  preferredInterestsMusic         InterestMusic[]       @default([])
  preferredInterestsNightlife     InterestNightlife[]   @default([])
  preferredInterestsTvCinema      InterestTvCinema[]    @default([])

  // DIST√ÇNCIA E IDADE
  maxDistanceKm Int @default(50)
  ageMin        Int @default(18)
  ageMax        Int @default(99)

  updatedAt     DateTime @updatedAt
}

model UserProfile {
  userId String @id @db.Uuid
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  // üîπ B√°sico
  bio        String?
  birthday   DateTime?
  preferredGenders Gender[] @default([])
  preferredOrientations SexualOrientation[] @default([])
  preferredPronouns Pronoun[] @default([])
  heightCm   Int?
  preferredIntentions        Intention[]        @default([])
  preferredRelationshipTypes RelationshipType[] @default([])
  preferredZodiacs ZodiacSign[] @default([])   
  

  // üîπ Localiza√ß√£o
  latitude  Decimal? @db.Decimal(9, 6)
  longitude Decimal? @db.Decimal(9, 6)

  

 // LIFESTYLE / H√ÅBITOS
  preferredPets          PetsPreference[]     @default([])
  preferredSmoking       SmokingStatus[]      @default([])
  preferredDrinking      DrinkingStatus[]     @default([])
  preferredActivityLevel ActivityFrequency[]   @default([])
  preferredCommunication CommunicationStyle[] @default([])
 

  // üîπ Trabalho / Educa√ß√£o
  jobTitle  String?
  company   String?
  preferredEducationLevels EducationLevel[] @default([])

    // L√çNGUAS
  preferredLanguages Language[] @default([])   
   

    // INTERESSES
  preferredInterestsActivities    InterestActivity[]    @default([])
  preferredInterestsLifestyle     InterestLifestyle[]   @default([])
  preferredInterestsCreativity    InterestCreativity[]  @default([])
  preferredInterestsSportsFitness InterestSports[]      @default([])
  preferredInterestsMusic         InterestMusic[]       @default([])
  preferredInterestsNightlife     InterestNightlife[]   @default([])
  preferredInterestsTvCinema      InterestTvCinema[]    @default([])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Payment {
  id          String        @id @default(uuid()) @db.Uuid
  userId      String        @db.Uuid
  user        User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  amount      Decimal       @db.Decimal(10, 2)
  currency    String        @default("USD")
  status      PaymentStatus @default(PENDING)

  referenceId String?

  createdAt   DateTime      @default(now())
  paidAt      DateTime?
  expiresAt   DateTime?

  plan        String?       // üî• ADICIONADO AQUI

  updatedAt   DateTime      @updatedAt

  productId String?  @db.Uuid
  product   Product? @relation(fields: [productId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([productId])
  @@index([userId, status])
  @@index([status, paidAt])
}

model Like {
  id        String   @id @default(uuid()) @db.Uuid
  likerId   String   @db.Uuid
  likedId   String   @db.Uuid
  createdAt DateTime @default(now())

  liker User @relation("LikesSent", fields: [likerId], references: [id], onDelete: Cascade)
  liked User @relation("LikesReceived", fields: [likedId], references: [id], onDelete: Cascade)

  @@unique([likerId, likedId])
  @@index([likerId])
  @@index([likedId])
}

model Product {
  id        String   @id @default(uuid()) @db.Uuid
  name      String
  kind      String
  credits   Int?
  minutes   Int?
  price     Decimal  @db.Decimal(10, 2)
  currency  String   @default("USD")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  payments     Payment[]
  boostCredits BoostCredit[]
}

model BoostCredit {
  id     String @id @default(uuid()) @db.Uuid
  userId String @db.Uuid
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  productId String?  @db.Uuid
  product   Product? @relation(fields: [productId], references: [id], onDelete: SetNull)

  type      BoostType
  credits   Int
  used      Int       @default(0)
  expiresAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  activations BoostActivation[]

  @@index([userId])
  @@index([expiresAt])
}

model BoostActivation {
  id     String @id @default(uuid()) @db.Uuid
  userId String @db.Uuid
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  type     BoostType
  status   BoostStatus @default(PENDING)
  startsAt DateTime
  endsAt   DateTime
  priority Int         @default(1)

  creditId String?      @db.Uuid
  credit   BoostCredit? @relation(fields: [creditId], references: [id], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([status, startsAt])
  @@index([status, endsAt])
  @@index([creditId])
}

model EnumLabel {
  id        String   @id @default(uuid()) @db.Uuid
  enumType  String
  enumValue String
  locale    String
  label     String
  createdAt DateTime @default(now())

  @@unique([enumType, enumValue, locale])
  @@index([enumType, locale])
}
